name: Fetch BF6 Stats and Update

on:
  # Umo쮄갓je spustit akci manu치ln캩
  workflow_dispatch: 
  # Spou코t칤 se automaticky ka쬯칳 den v 01:00 UTC
  schedule:
    - cron: '0 1 * * *' 

jobs:
  fetch-data:
    runs-on: ubuntu-latest
    
    # 游 Kl칤캜ov칠: Umo쮄갓je commit a push zp캩t do repozit치콏e.
    permissions:
      contents: write 
      
    steps:
      - name: Checkout k칩d
        uses: actions/checkout@v4

      - name: Vytvo콏en칤 slo쬶y pro data
        run: mkdir -p data

      - name: St치hni JSON data
        env:
          API_KEY: ${{ secrets.TRN_API_KEY }} # Z칤sk치 tajn칳 kl칤캜
        run: |
          URL="https://public-api.tracker.gg/v2/bf6/standard/profile/steam/3000691765"
          OUTPUT_FILE="data/bf6_stats.json"
          
          echo "Stahuji data..."
          
          # Pou쬴je se kl칤캜 z environment
          curl -s -X GET \
            -H "TRN-Api-Key: $API_KEY" \
            -H "Accept: application/json" \
            "$URL" \
            --compressed \
            --output "$OUTPUT_FILE"
          
          echo "Data sta쬰na do $OUTPUT_FILE"

      - name: Commit a Push JSON souboru
        # Tato akce automaticky commitne a nahraje zm캩ny
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          file_pattern: 'data/bf6_stats.json' # Ulo쮂 data do slo쬶y data/
          commit_message: 'Auto-update: BF6 Stats from Tracker.gg API'
          commit_author: github-actions[bot] <41898282+github-actions[bot]@users.noreply.github.com>
